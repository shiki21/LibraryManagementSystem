# 图书管理系统

- 5.4 增加需求：书评功能：在图书详情界面实现，由用户添加，图书管理员可对其进行管理
- 4.17 由于Django的MTV框架设定，在了解后更改人力资源分工安排。

## 一、软件计划文档

### 1.系统概述
    读书可以开阔视野，提升思想水平，充实心灵，修身养性。  
    由于学校藏书量大，借阅人数多，人工工作方式不仅会照成办理时间的延误和人力资源的浪费，
    而且存在着各种信息不宜存放、易丢失、难以备份和查询等缺点，  
    因此实现一个将各种图书管理和服务功能集合起来的管理系统就显得十分必要，
    既可以节省资源又可以有效存储、查询和更新信息，提高工作和服务效率。

### 2.软件开发过程模型
| 软件生命周期 | 是否首先定义好所有的需求 | 是否有多个开发周期 | 是否有中间软件 |
| :----: | :----: | :----: | :----: |
| 敏捷型 | 否 | 有 | 没有 |

### 3.项目估算
#### a) 规模估算
    模块复杂度估算为：中等模块，业务逻辑复杂度一般，表的访问个数不超过4个，数据展示量中等。
#### b) 进度估算  
![Gantt_chart](https://github.com/shiki21/LibraryManagementSystem/blob/main/media/甘特图.png)  

### 4.人力资源安排
| 项目模块 | 成员 |
| :----: | :----: |
| 框架搭建，需求分析，内容整合 | fjy |
| 图书的增删和修改 | mwj |
| 图书借阅、归还 | lhj |
| 用户信息及管理，借阅情况及管理 | mhx |
| 检索，图书详细信息及评论 | fjy |
| 前端UI整合优化 | lsm |

### 5.开发环境
#### 硬件环境
| 设备名称 | 用途 | 配置信息 | 备注 |
| :----: | :----: | :----: | :----: |
| Windowsdesktop | 正常使用 | Intel(R) Core(TM) i5-10400F CPU | 无 |

#### 软件环境
| 软件名称 | 软件类别 | 版本号 | 备注 |
| :----: | :----: | :----: | :----: |
| Windows 10 | 操作系统 | 21H1 | 无 |
| Visual Studio Code | IDE | 1.66.0 | 无 |
| Python | 计算机编程语言 | 3.7.6 | 无 |

### 6.测试环境
#### 硬件环境
| 设备名称 | 用途 | 配置信息 | 备注 |
| :----: | :----: | :----: | :----: |
| Windowsdesktop | 正常使用 | Intel(R) Core(TM) i5-10400F CPU | 无 |
| 待补充 | 待补充 | 待补充 | 待补充 |
#### 软件环境
| 软件名称 | 软件类别 | 版本号 | 备注 |
| :----: | :----: | :----: | :----: |
| Windows 10 | 操作系统 | 21H1 | 无 |
| Visual Studio Code | IDE | 1.66.0 | 无 |
| Python | 计算机编程语言 | 3.7.6 | 无 |

### 7.风险评估和控制
| 风险描述 | 降低风险策略 |
| :----: | :----: |
| 待补充 | 待补充 |

### 8.测试计划
| 测试 | 测试类型 | 负责人及成员 | 时间 |
| :----: | :----: | :----: | :----: |
| 待补充 | 待补充 | 待补充 | 待补充 |

### 9.评审计划
| 评审活动名称 | 评审对象 | 评审人员 | 评审活动时间 |
| :----: | :----: | :----: | :----: |
| 待补充 | 待补充 | 待补充 | 待补充 |

### 10.质量保证计划
项目QA人员组成
| QA任务 | 计划日期 | 活动形式 | QA人员 | 项目参与成员 |
| :----: | :----: | :----: | :----: | :----: |
| 待补充 | 待补充 | 待补充 | 待补充 | 待补充 |

***

## 二、需求分析
### 1.系统概述
    由于学校藏书量大，借阅人数多，人工工作方式不仅会照成办理时间的延误和人力资源的浪费，
    而且存在着各种信息不宜存放、易丢失、难以备份和查询等缺点，  
    因此实现一个将各种图书管理和服务功能集合起来的管理系统就显得十分必要，
    既可以节省资源又可以有效存储、查询和更新信息，提高工作和服务效率。  
    本系统将用于对图书馆藏书进行管理，包括但不局限于查询搜索、增添书目、修改信息、
    删除书目以及借阅、归还等功能，并在项目的第三个迭代周期内考虑扩展一定的功能，具体将在后期补充。  

    补充：在此基础上，还将扩展书评功能，实现在图书详情界面可由用户添加本书的评论，管理员也可对评论进行管理。

### 2.需求概述
#### **目标**
    本系统致力于更加高速有效地管理图书，可能应用于图书馆中。
#### **运行环境**
    可以运行于Windows/MacOS/Linux上的python环境下，python版本为3.7及以上，硬件环境没有硬性要求。
#### **用户特点**
    本系统涉及角色为图书管理员和学生，应实现的主要功能有在：
    管理员权限下的查询搜索、新增书目、修改信息、删除书目、管理评论，
    学生权限下的查询搜索、借阅图书、归还图书、评论。
#### **关键点**
    图书的增、删、改、查、借阅、归还。

### 3.运行环境
#### 软件环境
| 类别 | 名称 | 版本 |
| :----: | :----: | :----: |
| 操作系统 | Windows | win10 |
| 应用平台 | python | 3.7及以上 |
| 客户端软件 | django | 3.0以上 |
| 数据库 | django自带的sqlite | 跟随django版本 |
#### 硬件环境
无特殊要求

### 4.需求规定
#### 1)软件系统总体功能结构  

![Functional_structure_diagram](https://github.com/shiki21/LibraryManagementSystem/blob/main/media/系统功能结构图.png)

#### 2)功能需求
##### 数据流图
- 顶层数据流图  
    ![top_Data_Flow_Diagram](https://github.com/shiki21/LibraryManagementSystem/blob/main/media/顶层数据流图.png)  
- 数据流图及加工判定树  
    ![Data_Flow_Diagram](https://github.com/shiki21/LibraryManagementSystem/blob/main/media/数据流图.png)  
    
##### 用例图
- 总用例图  
    ![total_use_case_diagram](https://github.com/shiki21/LibraryManagementSystem/blob/main/media/总用例图.png)  
- 用例描述
    * __用例“注册”__
        > 该用例是用户使用系统前需要进行的必要步骤，通过注册并登陆即可使用系统。  
        > 角色为：图书管理员，学生。  
        > 无前置条件，后置条件为可以使用用例“登陆”。  
        > 基本流：进入用户注册界面，填写用户名，密码等信息后，若检查均合法，即可完成注册。  
        > 备用流：用户名/密码等填写不规范，注册失败，提示用户请重新输入。  
    * __用例“登陆”__
        > 该用例是用户使用系统前需要进行的必要步骤，通过前一步注册后即可登陆，登陆后才可使用系统其他功能。  
        > 角色为：图书管理员，学生。  
        > 前置条件为“注册”，后置条件为可以使用出注册外的其他功能。  
        > 基本流：进入用户注册界面，填写用户名，密码等信息后，若检查均合法，即可完成登陆。  
        > 备用流：用户名/密码等填写不规范，注册失败，提示用户请重新输入。  
    * __用例“查询搜索”__
        > 该用例是用户使用系统时用于查看信息的主要功能，通过查询搜索可以将系统内图书的信息呈现出来。  
        > 角色为：图书管理员，学生。  
        > 前置条件为“登陆”，无后置条件。
        > 基本流：进入查询搜索界面，填写关键词并点击搜索按钮，即可找到包含关键词的相应条目。  
        > 备用流：数据库中不包含搜索的关键词，提示用户无相关结果和请重新输入。  
    * __用例“新增图书”__
        > 该用例是管理员进行新增图书信息的功能，通过填写合法的信息可在库中加入新的图书条目。  
        > 角色为：图书管理员。  
        > 前置条件为“登陆”，后置条件为“修改信息”和“删除图书”。  
        > 基本流：进入新增图书界面，填写提示的所有图书所需要的信息后，若检查均合法，即可完成新增图书操作。  
        > 备用流：图书名，ISBN等信息填写不规范，新增失败，提示用户请重新输入。  
    * __用例“图书详细信息”__
        > 该用例是管理员进行修改图书信息的功能，通过修改合法的信息可在库中修改对应图书条目的部分或全部信息。  
        > 角色为：图书管理员。  
        > 前置条件为“登陆”和“新增图书”，无后置条件。  
        > 基本流：进入修改信息界面，重新填写所需要的信息后，若检查均合法，即可完成修改信息操作。  
        > 备用流：图书名，ISBN等信息填写不规范，修改失败，提示用户重新输入。
    * __用例“删除图书”__
        > 该用例是管理员进行删除图书条目的相关功能，可删除已不存在的多余书目。  
        > 角色为：图书管理员。  
        > 前置条件为“登陆”和“新增图书”，无后置条件。  
        > 基本流：进入删除图书界面，选择需要删除的图书条目，点击删除按钮并确认后，即可完成删除操作。  
    * __用例“借阅”__
        > 该用例是学生进行图书借阅的功能，在选择想借阅的图书后可修改库存剩余信息。  
        > 角色为：学生。  
        > 前置条件为“登陆”，后置条件为“归还”。  
        > 基本流：进入借阅界面，查找想要借阅的图书条目，若库存大于零，点击确认后即可完成借阅操作。  
        > 备用流：想要借阅的图书条目为零，借阅失败，提示用户请选择其他图书进行借阅。  
    * __用例“归还”__
        > 该用例是学生进行图书归还的功能，在选择想归还的图书后可修改库存剩余信息。  
        > 角色为：学生。  
        > 前置条件为“登陆”和“借阅”，无后置条件。  
        > 基本流：进入归还界面，查找想要归还的图书条目，点击确认后即可完成归还操作。  
    * __用例“评论”__
        > 该用例是学生进行图书评论、管理员对图书评论进行管理的功能，学生在点开图书详情后可对该图书进行评论，管理员可在后台对读书评论进行修改、删除等操作。  
        > 角色为：学生、管理员。  
        > 前置条件为“登陆”，无后置条件。  
        > 基本流：进入图书列表，点开图书详情页面，点击添加评论后输入评论内容，即可完成添加评论操作；管理员在后台点开评论界面，即可对想修改的评论信息进行修改。  

## 三、概要设计
### 1.系统概述
    由于学校藏书量大，借阅人数多，人工工作方式不仅会照成办理时间的延误和人力资源的浪费，
    而且存在着各种信息不宜存放、易丢失、难以备份和查询等缺点，  
    因此实现一个将各种图书管理和服务功能集合起来的管理系统就显得十分必要，
    既可以节省资源又可以有效存储、查询和更新信息，提高工作和服务效率。  
    本系统将用于对图书馆藏书进行管理，包括但不局限于查询搜索、增添书目、修改信息、
    删除书目以及借阅、归还等功能。
    在此基础上，还将扩展书评功能，实现在图书详情界面可由用户添加本书的评论，管理员也可对评论进行管理。

### 2.运行环境
#### 软件环境
| 类别 | 名称 | 版本 |
| :----: | :----: | :----: |
| 应用平台 | python | 3.7及以上 |
| 客户端软件 | django | 3.0以上 |
| 数据库 | django自带的sqlite | 跟随django版本 |
#### 硬件环境
无特殊要求
### 开发环境
| 类别 | 名称 | 版本 |
| :----: | :----: | :----: |
| 操作系统 | Windows | win10 |
| 应用平台 | python | 3.7及以上 |
| 客户端软件 | django | 3.0以上 |
| 数据库 | django自带的sqlite | 跟随django版本 |

### 3.软件架构图
![software_structure_diagram](https://github.com/shiki21/LibraryManagementSystem/blob/main/media/软件架构图.png)  

![django_mtv_2](https://github.com/shiki21/LibraryManagementSystem/blob/main/media/MTV_2.png)

![django_mtv_3](https://github.com/shiki21/LibraryManagementSystem/blob/main/media/MTV_3.png)

### 4.网络拓扑图
![django_mtv](https://github.com/shiki21/LibraryManagementSystem/blob/main/media/MTV.png)

### 5.关键技术及算法
    本系统基于python的Django框架实现，其基本模型是MTV模型。
* M 代表模型（Model），即数据存取层。该层处理与数据相关的所有事务： 如何存取、如何验证有效性、包含哪些行为以及数据之间的关系等。
* T 代表模板(Template)，即表现层。该层处理与表现相关的决定： 如何在页面或其他类型文档中进行显示。
* V 代表视图（View），即业务逻辑层。该层包含存取模型及调取恰当模板的相关逻辑，可以把它看作模型与模板之间的桥梁。

![django_key](https://github.com/shiki21/LibraryManagementSystem/blob/main/media/MTV_KEY.png)

    可以看到除了Models，view，template以外，还有一个url分发器，这个url分发器在Django整个架构中尤为重要，
    在用户访问时接受的url请求分发给不同的view处理，view视图函数在根据需求去返回前端Telmplate页面或者调用后台Model数据库。
    一般是用户通过浏览器向我们的服务器发起一个请求(request)，这个请求回去访问视图函数，
    （如果不涉及到数据调用，那么这个时候视图函数返回一个模板也就是一个网页给用户），
    视图函数调用模型，模型去数据库查找数据，然后逐级返回，视图函数把返回的数据填充到模板中空格中，最后返回网页给用户。

    算法有Models.objects.get(),Models.objects.filter(),admin.site.register()等

### 6.系统功能设计
#### 功能介绍
* __功能“注册”__
    > 该功能是用户使用系统前需要进行的必要步骤，通过注册并登陆即可使用系统。  
    > 角色为：图书管理员，学生。  
    > 无前置条件，后置条件为可以使用功能“登陆”。  
    > 基本操作：进入用户注册界面，填写用户名，密码等信息后，若检查均合法，即可完成注册。用户名/密码等填写不规范，注册失败，提示用户请重新输入。  
* __功能“登陆”__
    > 该功能是用户使用系统前需要进行的必要步骤，通过前一步注册后即可登陆，登陆后才可使用系统其他功能。  
    > 角色为：图书管理员，学生。  
    > 前置条件为“注册”，后置条件为可以使用出注册外的其他功能。  
    > 基本操作：进入用户注册界面，填写用户名，密码等信息后，若检查均合法，即可完成登陆。用户名/密码等填写不规范，注册失败，提示用户请重新输入。  
* __功能“查询搜索”__
    > 该功能是用户使用系统时用于查看信息的主要功能，通过查询搜索可以将系统内图书的信息呈现出来。  
    > 角色为：图书管理员，学生。  
    > 前置条件为“登陆”，无后置条件。
    > 基本操作：进入查询搜索界面，填写关键词并点击搜索按钮，即可找到包含关键词的相应条目。数据库中不包含搜索的关键词，提示用户无相关结果和请重新输入。  
* __功能“新增图书”__
    > 该功能是管理员进行新增图书信息的功能，通过填写合法的信息可在库中加入新的图书条目。  
    > 角色为：图书管理员。  
    > 前置条件为“登陆”，后置条件为“修改信息”和“删除图书”。  
    > 基本操作：进入新增图书界面，填写提示的所有图书所需要的信息后，若检查均合法，即可完成新增图书操作。图书名，ISBN等信息填写不规范，新增失败，提示用户请重新输入。  
* __功能“图书详细信息”__
    > 该功能是管理员进行修改图书信息的功能，通过修改合法的信息可在库中修改对应图书条目的部分或全部信息。  
    > 角色为：图书管理员。  
    > 前置条件为“登陆”和“新增图书”，无后置条件。  
    > 基本操作：进入修改信息界面，重新填写所需要的信息后，若检查均合法，即可完成修改信息操作。图书名，ISBN等信息填写不规范，修改失败，提示用户重新输入。
* __功能“删除图书”__
    > 该功能是管理员进行删除图书条目的相关功能，可删除已不存在的多余书目。  
    > 角色为：图书管理员。  
    > 前置条件为“登陆”和“新增图书”，无后置条件。  
    > 基本操作：进入删除图书界面，选择需要删除的图书条目，点击删除按钮并确认后，即可完成删除操作。  
* __功能“借阅”__
    > 该功能是学生进行图书借阅的功能，在选择想借阅的图书后可修改库存剩余信息。  
    > 角色为：学生。  
    > 前置条件为“登陆”，后置条件为“归还”。  
    > 基本操作：进入借阅界面，查找想要借阅的图书条目，若库存大于零，点击确认后即可完成借阅操作。想要借阅的图书条目为零，借阅失败，提示用户请选择其他图书进行借阅。  
* __功能“归还”__
    > 该功能是学生进行图书归还的功能，在选择想归还的图书后可修改库存剩余信息。  
    > 角色为：学生。  
    > 前置条件为“登陆”和“借阅”，无后置条件。  
    > 基本操作：进入归还界面，查找想要归还的图书条目，点击确认后即可完成归还操作。  
* __功能“评论”__
    > 该功能是学生进行图书评论、管理员对图书评论进行管理的功能，学生在点开图书详情后可对该图书进行评论，管理员可在后台对读书评论进行修改、删除等操作。  
    > 角色为：学生、管理员。  
    > 前置条件为“登陆”，无后置条件。  
    > 基本操作：进入图书列表，点开图书详情页面，点击添加评论后输入评论内容，即可完成添加评论操作；管理员在后台点开评论界面，即可对想修改的评论信息进行修改。 

#### UML类图及顺序图

![UML](https://github.com/shiki21/LibraryManagementSystem/blob/main/media/UML.png)

### 7.数据库设计
#### 1)采用的数据库
    本系统采用Django自带的sqlite3，管理方式由Django内的方法实现，版本跟随Django版本。
    django中内嵌了ORM框架，不需要直接面向数据库编程，而是定义模型类，通过模型类和对象完成数据表的增删改查操作。
    O是object，也就类对象的意思，R是relation，翻译成中文是关系，也就是关系数据库中数据表的意思，M是mapping，是映射的意思。
    在ORM框架中，它帮我们把类和数据表进行了一个映射，可以让我们通过类和类对象就能操作它所对应的表格中的数据。
    ORM框架还有一个功能，它可以根据我们设计的类自动帮我们生成数据库中的表格，省去了我们自己建表的过程。

![django_ORM](https://github.com/shiki21/LibraryManagementSystem/blob/main/media/ORM.png)

    使用django进行数据库开发的步骤如下：
* 配置数据库连接信息，默认初始配置使用sqlite数据库
* 在models.py中定义模型类
* 迁移
* 通过类和对象完成数据增删改查操作
#### 2)数据库表设计
以下表中列出主要内容，实际创建时由于Django的ORM框架，数据部分形式可能不同。
##### Book
| 字段名 | 字段数据类型 | 字段是否为空 | 字段默认值 | 字段说明 |
| :----: | :----: | :----: | :----: | :----: |
|id|int|不为空|（未指定时）默认新增id主键|主键，自动增一，唯一|
|ISBN|char|不为空|创建时需指定|唯一，数据检查|
|title|char|不为空|创建时需指定||
|category|char|不为空|创建时需指定|外键|
|page|char|不为空|创建时需指定||
|cover_img|image|不为空|创建时需添加||
|author|char|不为空|创建时需指定||
|price|char|不为空|创建时需指定||
|publisher|char|不为空|创建时需指定||
|pubdate|char|不为空|创建时需指定||
|summary|text|不为空|创建时需指定||
|stock|int|不为空|创建时需指定||
##### CommonUser
| 字段名 | 字段数据类型 | 字段是否为空 | 字段默认值 | 字段说明 |
| :----: | :----: | :----: | :----: | :----: |
|id|int|不为空|（未指定时）默认新增id主键|主键，自动增一，唯一|
|name|char|不为空|创建时需指定||
|email|char|不为空|创建时需指定|外键|
|faculty|char|不为空|创建时需指定,admin为'undefine'||
##### BorrowList
| 字段名 | 字段数据类型 | 字段是否为空 | 字段默认值 | 字段说明 |
| :----: | :----: | :----: | :----: | :----: |
|id|int|不为空|（未指定时）默认新增id主键|主键，自动增一，唯一|
|UserId|char|不为空|创建时自动指定|外键|
|BookId|char|不为空|创建时自动指定|外键|
|BorrowDate|char|不为空|创建时自动指定||
|ReturnDate|char|可为空|归还时指定||
##### Comments
| 字段名 | 字段数据类型 | 字段是否为空 | 字段默认值 | 字段说明 |
| :----: | :----: | :----: | :----: | :----: |
|id|int|不为空|（未指定时）默认新增id主键|主键，自动增一，唯一|
|UserId|char|不为空|创建时自动指定|外键|
|BookId|char|不为空|创建时自动指定|外键|
|content|char|不为空|创建时需指定||
